{% extends 'base.html' %} {% load static %} 

{% block sidebar %}
    {% with sidebar_content=True %}
        {% include 'campanhas/partials/file_tree.html' with campanha=object %}
    {% endwith %}
{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>{{ categoria.nome }}</h1>
  <div>
    <a
      href="{% url 'campanhas:campo-create' categoria.pk %}"
      class="btn btn-outline-primary me-2"
    >
      <i class="bi bi-plus-circle"></i> Adicionar Campo
    </a>
    <a
      href="{% url 'campanhas:entidade-create' categoria.pk %}"
      class="btn btn-custom"
    >
      <i class="bi bi-plus-circle"></i> Nova Entidade
    </a>
  </div>
</div>

{% if categoria.descricao %}
<div class="card mb-4">
  <div class="card-body">
    <p class="card-text">{{ categoria.descricao }}</p>
  </div>
</div>
{% endif %}

<div class="row">
  <div class="col-md-6">
    <h3>Entidades</h3>
    {% if entidades %}
    <div class="list-group">
      {% for entidade in entidades %}
      <a
        href="{% url 'campanhas:entidade-detail' entidade.pk %}"
        class="list-group-item list-group-item-action"
      >
        <div class="d-flex w-100 justify-content-between">
          <h5 class="mb-1">{{ entidade.nome }}</h5>
          <small>Criado em {{ entidade.created_at|date:"d/m/Y" }}</small>
        </div>
        <p class="mb-1">{{ entidade.descricao|truncatechars:50 }}</p>
      </a>
      {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-info">
      Nenhuma entidade criada ainda. Clique em "Nova Entidade" para começar.
    </div>
    {% endif %}
  </div>

  <div class="col-md-6">
    <h3>Campos Personalizados</h3>
    {% if campos %}
    <table class="table">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Tipo</th>
          <th>Obrigatório</th>
        </tr>
      </thead>
      <tbody>
        {% for campo in campos %}
        <tr>
          <td>{{ campo.nome }}</td>
          <td>{{ campo.get_tipo_display }}</td>
          <td>{% if campo.obrigatorio %}Sim{% else %}Não{% endif %}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <div class="alert alert-info">
      Nenhum campo definido ainda. Adicione campos para começar a criar
      entidades.
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
